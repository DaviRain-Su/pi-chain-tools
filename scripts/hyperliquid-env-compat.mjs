const warned = new Set();

function mapKey(env, newKey, oldKey) {
	if (env[newKey] == null || String(env[newKey]).trim() === "") {
		const oldValue = env[oldKey];
		if (oldValue != null && String(oldValue).trim() !== "") {
			env[newKey] = oldValue;
			if (!warned.has(oldKey)) {
				warned.add(oldKey);
				console.warn(
					`[deprecation] ${oldKey} is deprecated. Use ${newKey} instead.`,
				);
			}
		}
	}
}

export function applyLegacyBscAutonomousEnvCompat(env = process.env) {
	const mappings = [
		["HYPERLIQUID_AUTONOMOUS_MODE", "BSC_AUTONOMOUS_MODE"],
		["HYPERLIQUID_AUTONOMOUS_CYCLE_ID", "BSC_AUTONOMOUS_CYCLE_ID"],
		[
			"HYPERLIQUID_AUTONOMOUS_CYCLE_INTERVAL_SECONDS",
			"BSC_AUTONOMOUS_CYCLE_INTERVAL_SECONDS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_EXECUTE_BINDING_ENABLED",
			"BSC_AUTONOMOUS_HYPERLIQUID_EXECUTE_BINDING_ENABLED",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_EXECUTE_BINDING_REQUIRED",
			"BSC_AUTONOMOUS_HYPERLIQUID_EXECUTE_BINDING_REQUIRED",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_EXECUTE_ACTIVE",
			"BSC_AUTONOMOUS_HYPERLIQUID_EXECUTE_ACTIVE",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_EXECUTE_COMMAND",
			"BSC_AUTONOMOUS_HYPERLIQUID_EXECUTE_COMMAND",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_ROUTER_ADDRESS",
			"BSC_AUTONOMOUS_HYPERLIQUID_ROUTER_ADDRESS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_EXECUTOR_ADDRESS",
			"BSC_AUTONOMOUS_HYPERLIQUID_EXECUTOR_ADDRESS",
		],
		["HYPERLIQUID_AUTONOMOUS_ENABLED", "BSC_AUTONOMOUS_HYPERLIQUID_ENABLED"],
		[
			"HYPERLIQUID_AUTONOMOUS_API_BASE_URL",
			"BSC_AUTONOMOUS_HYPERLIQUID_API_BASE_URL",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_TIMEOUT_MS",
			"BSC_AUTONOMOUS_HYPERLIQUID_TIMEOUT_MS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_LIVE_COMMAND",
			"BSC_AUTONOMOUS_HYPERLIQUID_LIVE_COMMAND",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_CONFIRM_TEXT",
			"BSC_AUTONOMOUS_HYPERLIQUID_CONFIRM_TEXT",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_MAX_AMOUNT_RAW",
			"BSC_AUTONOMOUS_HYPERLIQUID_MAX_AMOUNT_RAW",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_CONTRACT_ADDRESS",
			"BSC_AUTONOMOUS_CONTRACT_ADDRESS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_CONTRACT_MAX_AMOUNT_RAW",
			"BSC_AUTONOMOUS_CONTRACT_MAX_AMOUNT_RAW",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_CONTRACT_COOLDOWN_SECONDS",
			"BSC_AUTONOMOUS_CONTRACT_COOLDOWN_SECONDS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_EMERGENCY_ADMIN",
			"BSC_AUTONOMOUS_EMERGENCY_ADMIN",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_CONTRACT_ENTRYPOINT_ENABLED",
			"BSC_AUTONOMOUS_CONTRACT_ENTRYPOINT_ENABLED",
		],
		["HYPERLIQUID_AUTONOMOUS_TRIGGER_JSON", "BSC_AUTONOMOUS_TRIGGER_JSON"],
		[
			"HYPERLIQUID_AUTONOMOUS_CYCLE_MIN_LIVE_INTERVAL_SECONDS",
			"BSC_AUTONOMOUS_CYCLE_MIN_LIVE_INTERVAL_SECONDS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_CYCLE_LOCK_TTL_SECONDS",
			"BSC_AUTONOMOUS_CYCLE_LOCK_TTL_SECONDS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_RECONCILE_SNAPSHOT_COMMAND",
			"BSC_AUTONOMOUS_RECONCILE_SNAPSHOT_COMMAND",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_RECONCILE_SNAPSHOT_TIMEOUT_MS",
			"BSC_AUTONOMOUS_RECONCILE_SNAPSHOT_TIMEOUT_MS",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_RECONCILE_BEFORE_COMMAND",
			"BSC_AUTONOMOUS_RECONCILE_BEFORE_COMMAND",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_RECONCILE_AFTER_COMMAND",
			"BSC_AUTONOMOUS_RECONCILE_AFTER_COMMAND",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_ONCHAIN_TRIGGER_REQUIRED",
			"BSC_AUTONOMOUS_ONCHAIN_TRIGGER_REQUIRED",
		],
		["HYPERLIQUID_AUTONOMOUS_ROUTER_ADDRESS", "BSC_AUTONOMOUS_ROUTER_ADDRESS"],
		["HYPERLIQUID_AUTONOMOUS_TOKEN_IN", "BSC_AUTONOMOUS_HYPERLIQUID_TOKEN_IN"],
		[
			"HYPERLIQUID_AUTONOMOUS_TOKEN_OUT",
			"BSC_AUTONOMOUS_HYPERLIQUID_TOKEN_OUT",
		],
		[
			"HYPERLIQUID_AUTONOMOUS_AMOUNT_RAW",
			"BSC_AUTONOMOUS_HYPERLIQUID_AMOUNT_RAW",
		],
		["HYPERLIQUID_TESTNET_RPC_URL", "BSC_TESTNET_RPC_URL"],
		["HYPERLIQUID_TESTNET_PRIVATE_KEY", "BSC_TESTNET_PRIVATE_KEY"],
	];
	for (const [newKey, oldKey] of mappings) mapKey(env, newKey, oldKey);
	return env;
}
